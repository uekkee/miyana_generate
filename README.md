# Project Miyana - 雅凪

## 1. プロジェクト概要

miyana プロジェクトは、理想の女性キャラクター「雅凪（みやな）」を LoRA（Low-Rank Adaptation）で具現化する取り組み。現在は、チェックポイント「Illustrious XL 1.1」を用いた高品質な LoRA の作成を目指している。

このプロジェクトの思想は以下の通り：

- キャラクター造形の一貫性と高解像度な表現を両立する
- 特定のスタイルに一時的に依存しつつも、最終的には汎用性の高いキャラクター表現を目指す
- 技術的検証と芸術的探究の両立

## 2. ロードマップ

### マイルストーン 1：LoRA モデル v3.0、プロンプト v3.0

- **目的**：特定のスタイルに依存した理想像の精緻化
- **手法**：
  - Illustrious XL 1.1 など汎用寄りチェックポイントの利用
  - スタイル、髪型、衣装を固定し、詳細化したプロンプトを作成
  - 局所最適から全体最適への構図展開（顔 → バストアップ → 全身 → 背面）

### マイルストーン 2：LoRA モデル v4.0、プロンプト v4.0

- **目的**：スタイル間の汎用性を追求した LoRA へ進化
- **手法**：

  - 多スタイル対応プロンプト設計
  - スタイル調整タグの実験と評価
  - 複数構図・複数表現の学習素材追加

### マイルストーン 3：LoRA 汎用化と公開展開

- **目的**：誰もが自由に「雅凪」を使える環境を提供
- **手法**：

  - モデルアーキテクチャの多様化（XL、Turbo、SD1.5 対応など）
  - モデル API 経由の活用（例：Web UI、Discord Bot、画像生成 API）

---

### 3. 本 Project のディレクトリ構造

- src: ソースコード。今のところは属性マップの markdown を保存
- prompts: 構図ごとのプロンプト。構図ごとにディレクトリを作成し、ポジティブ / ネガティブプロンプトをテキスト形式で保存
- learning_sources: LoRA 学習用に用いる素材の格納場所。構図ごとにディレクトリを作成し、そこに学習画像とタグファイルを設置

## 4. Markdown による属性マップの管理方法

### 属性マップの場所

- [ポジティブプロンプト](src/positive_attribute_map.md)

### コンセプト

LoRA 構築・検証の効率化のため、プロンプトをカテゴリ別に構造化し、構図別に使用有無および重み付けの数値を設定する。

### 記述フォーマット

属性マップは Markdown Table でマトリクス形式で記述する。

#### 列

以下の順で定義されている。

- タグ日本語名説明
- タグの英名（実際にプロンプトで使われる名前）
- 以降は構図名（front, close up など）

> ⚠️ 構図名（例：`front`, `back`, `close-up` など）は現段階では仮称です。
> 今後の検証および素材整備により、正式な命名および仕様として確定予定です。

#### 行

各タグの情報を記述。
構図名の列に対しては、以下の値が設定される

- `o` = 使用
- `x` = 不使用
- `1.2` などの数値 = 重み付けをする場合の値

#### タグのカテゴリごとのグルーピング

メンテナンス性を高めるため、タグのカテゴリごとにテーブルを定義する。

カテゴリ名は ## タグで記載する

#### 記載例

```md
### 🖼️ クオリティ・スタイル

| 日本語名 | タグ名       | front | back | left-side | close-up |
| :------- | :----------- | :---- | :--- | :-------- | :------- |
| 傑作     | masterpiece  | o     | o    | o         | o        |
| 最高品質 | best quality | o     | o    | o         | o        |

### 🧍‍♀️ ポーズ・構図

| 日本語名         | タグ名               | front | back | left-side | close-up |
| :--------------- | :------------------- | :---- | :--- | :-------- | :------- |
| 立っている       | standing             | o     | o    | o         | o        |
| 何も持っていない | not holding anything | 1.2   | 1.2  | 1.2       | x        |
```

### 活用目的

- プロンプト構築の高速化
- 属性の一貫性維持と構図ごとの差異可視化
- LoRA 学習素材のバリエーション管理と再生成支援

## 5. 属性マップより出力されるプロンプトのフォーマット

ヒューマンリーダブルを保つため、以下のルールとする

- 各タグは 1 行ごとに記述し、行末にはカンマを付ける
- カテゴリ名はプロンプトには含めない（ツールがタグと誤認するリスクを避けるため）
- 代わりに、カテゴリ単位で 1 行の空行を挿入し、視認性を確保する

### 例

```
masterpiece,
best quolity,

standing,
(not holding anything:1.2),
```
