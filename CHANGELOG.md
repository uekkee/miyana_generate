# Change logs

## v3.2.7

- プロンプト自動投入スクリプト追加
- スクリプト開発環境の整備

## v3.2.6

- 属性マップの「髪型」を安定化調整

## v3.2.5

- スタイルマップ・属性マップを「複数 LoRA 管理」に耐えうる構造に改善

## v3.2.4

- 属性マップの「ベース雅凪化暫定対応」
  - 髪型はセミロングストレートアレンジ
  - 髪飾りの除去
  - ただし、生成結果は安定収束しないので、各マップにさらなるブラッシュアップが必要（ゆえに「暫定版」）

## v3.2.3

作業の過程で文脈が混乱し、マイルストーンの目標は未達成。

ベース雅凪のプロンプトのソースとなる「各種マップ」の反映までには至れず。

以下の成果を持ち帰る

### 髪型の方向性が fix

- 髪型は「セミロングストレート系」が良さそう
- 単なる「ストレート」ではなく「上品な丸み感・ボリューム感」を出すことで、雅凪のもつ癒やし包容力を再現

### 成果物

- front 構図での「セミロングストレートの雅凪のプロンプト」
  - ただしまだ不安定。要ブラッシュアップ。
- back 構図での「セミロングストレート髪型テンプレートのテンプレート」
  - 「髪型だけ」は理想。人物像や背景などは異なりベース雅凪のプロンプトではない。要プロンプトのマージ

保管場所は下記

- [実験過程で得られたプロンプト](artifacts/v3.2.3_not_completed/prompts/)
- [プロンプトの出力結果の良サンプル](artifacts/v3.2.3_not_completed/images/)

## v3.2.2

- GHA による「スタイル」x「構図」の全プロンプト生成スクリプトを追加

## v3.2.1

- チェックポイントを `WAI-NSFW-illustrious-SDXL` に回帰
- v2.1 のプロンプトを「属性マップ」「スタイルマップ」に変換
- 各種アーティファクトを保存

## v3.1

### 目標

- checkpoint: `Illustrious-XL 1.1` を採用し、LoRA 学習素材に外見特徴を調整した「ベース雅凪 LoRA を作る」

### 結果として目標達成ならず。v3.1 は凍結

- `Illustrious-XL 1.1` では、プロンプトだけでは安定したスタイルに収束することができなかった

### 成果

- スタイルマップを定義定義
  - 「スタイル」と「属性」を分けて管理することで 「スタイル」x「構図」を組み合わせたプロンプトを作れる

### 学び

- 「LoRA を学習容易な単位で分割」し「組み合わせる」事で最終的な「理想の雅凪」を作り出すという「構想の発見」
  - ベース雅凪 LoRA: 左右非対称な部品学習がしにくい要素（横に流した髪、かんざしなど）を排除したベースとなるモデル
  - パーツ LoRA: 各部品にスコープした単位で素材収集、タグ付けを行うことで実現
- 汎用 checkpoint では、プロンプトのコントロールだけで LoRA 学習素材となりうる安定したスタイルを実現する事は困難
  - LoRA 学習素材をプロンプトで作るには、スタイルにバイアスがかかったチェックポイントは必要

### 次バージョンの展望

- 次バージョンでは checkpoint: `WAI-NSFW-illustrious-SDXL` を再度採用し、「ベース雅凪 LoRA の作成」に再挑戦
  - 「ベース雅凪 LoRA」の範囲内なら、安定的な素材収集が期待できる
  - NSFW 問題も「ベース素材なら背面クローズアップは不要」なのでクリアできる見込み

## v3.0

### 目標

- checkpoint: `Illustrious-XL 1.1` を採用し、「理想の雅凪を作る準備」をする
- 属性マップを定義: 様々な構図に対応した雅凪プロンプトを出力できるようにする

### Illustrious-XL 1.1 を採用した理由

- 汎用的寄りなチェックポイントを使うことで、より精度の高いタグセットを模索
- NSFW な出力は抑えられているので、様々な構図に対応できることを期待

### 成果

- 属性マップのフォーマット定義
- Illustrious で「っぽい雅凪」は出るようなプロンプトは定義できた

## v2.x まで

### 目標

- 理想の雅凪 LoRA を作る
  - 採用した checkpoint: `WAI-NSFW-illustrious-SDXL` を採用

### 結果として目標達成ならず。v2.x は凍結

LoRA 素材の収集途中で断念。

- 特定の構図（背面のクローズアップ）で NSFW な出力結果が頻発
- 左右非対称の部位の出力結果が不安定
  - 「左右反転」「左右対称」の出力が頻発

### 成果

- プロンプトから理想の雅凪像を定義し [コンセプトアート](./concept_images/) を収集できた

### 学び

- checkpoint: `WAI-NSFW-illustrious-SDXL` の特性・傾向をつかめた
  - 比較的安定したスタイルに収束する傾向
    - プロンプトの人物属性から、特定のスタイルを優先的に選択する傾向（つまり一定のバイアスがある）
  - バイアスの影響で NSFW が頻発する構図傾向
    - 特に背面クローズアップ。うなじを強調した着崩れが高確率で発生
